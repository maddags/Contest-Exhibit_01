favorite_alcohol_total_index <- read.xlsx("~/동아리/공모전/가공데이터/excel/소비자물가지수_술_연별_전국.xlsx",
1,
colIndex = 1:4,
rowIndex = 1:77,
header = T,
encoding = "UTF-8")
library(xlsx)
library(ggplot2)
favorite_alcohol_total_index <- read.xlsx("~/동아리/공모전/가공데이터/excel/소비자물가지수_술_연별_전국.xlsx",
1,
colIndex = 1:4,
rowIndex = 1:77,
header = T,
encoding = "UTF-8")
favorite_alcohol_total_index
ggplot(data = favorite_alcohol_total_index) +
geom_bar(aes(x=연도, y = 상승률, fill = 항목), stat = "identity", position = 'dodge', colour = "black") +
ggtitle("술 물가상승률(전국)") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(hjust = 0.5))+
ylab("소비자물가지수 \n (2015 = 100)")+
theme(axis.title.y = element_text(size = 9))
ggplot(data = favorite_alcohol_total_index) +
geom_bar(aes(x=연도, y = 상승률, fill = 항목), stat = "identity", position = 'dodge', colour = "black") +
ggtitle("주류 물가상승률(전국)") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(hjust = 0.5))+
ylab("소비자물가지수 \n (2015 = 100)")+
theme(axis.title.y = element_text(size = 9))
favorite_alcohol_seoul_index <- read.xlsx("~/동아리/공모전/가공데이터/excel/소비자물가지수_술_연별_서울특별시.xlsx",
1,
colIndex = 1:4,
rowIndex = 1:77,
header = T,
encoding = "UTF-8")
favorite_alcohol_seoul_index
ggplot(data = favorite_alcohol_seoul_index) +
geom_bar(aes(x=연도, y = 상승률, fill = 항목), stat = "identity", position = 'dodge', colour = "black") +
ggtitle("주류 물가상승률(서울특별시)") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(hjust = 0.5))+
ylab("소비자물가지수 \n (2015 = 100)")+
theme(axis.title.y = element_text(size = 9))
ggplot(data = favorite_alcohol_seoul_index) +
geom_bar(aes(x=연도, y = 상승률, fill = 항목), stat = "identity", position = 'dodge', colour = "black") +
ggtitle("주류 물가상승률(서울특별시)") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(hjust = 0.5))+
ylab("상승률(%)")+
theme(axis.title.y = element_text(size = 9))
ggplot(data = favorite_alcohol_seoul_index) +
geom_bar(aes(x=연도, y = 상승률, fill = 항목), stat = "identity", position = 'dodge', colour = "black") +
ggtitle("주류 물가상승률(서울특별시)") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(hjust = 0.5))+
ylab("상승률(%)")+
theme(axis.title.y = element_text(size = 12))
ggplot(data = favorite_alcohol_seoul_index) +
geom_bar(aes(x=연도, y = 상승률, fill = 항목), stat = "identity", position = 'dodge', colour = "black") +
ggtitle("주류 물가상승률(서울특별시)") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(hjust = 0.5))+
ylab("상승률(%)")+
theme(axis.title.y = element_text(size = 10))
ggplot(data = favorite_alcohol_seoul_index) +
geom_bar(aes(x=연도, y = 상승률, fill = 항목), stat = "identity", position = 'dodge', colour = "black") +
ggtitle("주류 물가상승률(서울특별시)") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(hjust = 0.5))+
ylab("상승률(%)")+
theme(axis.title.y = element_text(size = 11))
ggplot(data = favorite_seoul_index) +
geom_bar(aes(x=연도, y = 상승률, fill = 항목), stat = "identity", position = 'dodge', colour = "black") +
ggtitle("술,담배 물가상승률(서울특별시)") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(hjust = 0.5))+
ylab("상승률(%)")+
theme(axis.title.y = element_text(size = 11))
library(xlsx)
library(ggplot2)
favorite_seoul_index <- read.xlsx("~/동아리/공모전/가공데이터/excel/소비자물가지수_담배.술_연별_서울특별시.xlsx",
1,
colIndex = 1:4,
rowIndex = 1:96,
header = T,
encoding = "UTF-8")
favorite_seoul_index
ggplot(data = favorite_seoul_index) +
geom_bar(aes(x=연도, y = 상승률, fill = 항목), stat = "identity", position = 'dodge', colour = "black") +
ggtitle("술,담배 물가상승률(서울특별시)") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(hjust = 0.5))+
ylab("상승률(%)")+
theme(axis.title.y = element_text(size = 11))
favorite_total_index <- read.xlsx("~/동아리/공모전/가공데이터/excel/소비자물가지수_담배,술_연별_전국.xlsx",
1,
colIndex = 1:4,
rowIndex = 1:96,
header = T,
encoding = "UTF-8")
favorite_total_index
ggplot(data = favorite_total_index) +
geom_bar(aes(x=연도, y = 상승률, fill = 항목), stat = "identity", position = 'dodge', colour = "black") +
ggtitle("술,담배 물가상승률(전국)") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(hjust = 0.5))+
ylab("상승률(%)")+
theme(axis.title.y = element_text(size = 11))
favorite_alcohol_total_index <- read.xlsx("~/동아리/공모전/가공데이터/excel/소비자물가지수_술_연별_전국.xlsx",
1,
colIndex = 1:4,
rowIndex = 1:77,
header = T,
encoding = "UTF-8")
favorite_alcohol_total_index
ggplot(data = favorite_alcohol_total_index) +
geom_bar(aes(x=연도, y = 상승률, fill = 항목), stat = "identity", position = 'dodge', colour = "black") +
ggtitle("주류 물가상승률(전국)") +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.title = element_text(hjust = 0.5))+
ylab("상승률(%)")+
theme(axis.title.y = element_text(size = 11))
View(new_data)
new_data_nax<- complete.cases(new_data)
new_data_nax
View(new_data_nax)
new_data[,complete.cases(new_Data)]
new_data[,complete.cases(new_data)]
as.data.frame(new_data, complete.cases = T)
as.data.frame(new_data, complete.cases = F)
new_data_nax <- na.omit(new_data)
new_data_nax <- na.omit(new_data)
new_data_nax
View(new_data_nax)
new_data_nax_all_row <- na.omit(new_data)
rm(list="new_data_nax")
new_data_allrow_del<- na.omit(new_data) # na.omit : 결측값이 있는 행 자체를 제거
rm(list = "new_data_nax_all_row")
install.packages("NbClust")
library(NbClust)
NbClust(data = new_data_allrow_del, diss = F,distance = "binary", min.nc = 2,max.nc = 10,
method = "kmeans")
View(new_data_allrow_del)
a <- as.matirx(new_data_allrow_del)
a <- as.matrix(new_data_allrow_del)
NbClust(data = a, diss = F,distance = "binary", min.nc = 2,max.nc = 10,
method = "kmeans")
NbClust(data = new_data_allrow_del, min.nc = 2,max.nc = 10,
method = "kmeans")
NbClust(data = a, min.nc = 2,max.nc = 10,
method = "kmeans")
NbClust(data = a)
NbClust(data = a, method = "kmeans")
#install.packages("NbClust")
library(NbClust)
#결측값이 포함된 행 제거
new_data_allrow_del<- na.omit(new_data) # na.omit : 결측값이 있는 행 자체를 제거
a <- as.matrix(new_data_allrow_del)
a
View(a)
View(a)
rownames(a) <- new_data_allrow_del$ID
a
View(a)
row_name_id <- a[,-1]
View(row_name_id)
install.packages("flexclust")
install.packages("hclust")
install.packages("cluster")
library(cluster)
d = dist(row_name_id)
scale(row_name_id)
scale(a)
head(row_name_id,4)
row_name_id <- a[,-8:-9]
View(row_name_id)
a <- as.matrix(new_data_allrow_del)
rownames(a) <- new_data_allrow_del$ID
row_name_id <- a[,-1]
row_name_id <- row_name_id[,-8:-9]
View(row_name_id)
dist(row_name_id)
scale(row_name_id)
str(row_name)
str(row_name_id)
as.integer(row_name_id)
View(row_name_id)
str(row_name_id)
scale(row_name_id)
row_name_id = mapply(row_name_id, Fun = as.numeric)
row_name_id = mapply(row_name_id, FUN = as.numeric)
View(row_name_id)
row_name_id <- matrix(row_name_id, ncol = 21, nrow = 95660)
View(row_name_id)
View(a)
row_name_id_1 <- a[,-1]
rownames(row_name_id) <- new_data_allrow_del$ID
View(row_name_id)
row_name_id_1 <- a[,-1]
row_name_id_2 <- row_name_id_1[,-8:-9]
View(row_name_id_2)
colnames(row_name_id) <- c("건강만족도","가족수입만족도","주거환경만족도","가족관계만족도","
직업만족도","사회적친분관계만족도","여가생활만족도","졸업(중학교)",
"졸업(초등학교)","졸업(대학교)","졸업(전문대학)","졸업(고등학교)","미취학(7세미만)",
"미취학(7세이상)","졸업(석사)","졸업(박사)","지역구분(서울)","지역구분(시)",
"지역구분(광역시)","지역구분(군)","지역구분(도농복합군)")
View(row_name_id)
str(row_name_id)
dist(row_name_id)
scale(row_name_id)
data_scaled <- scale(row_name_id)
View(data_scaled)
data_scaled <- scale(row_name_id, center = F, scale = T)
View(data_scaled)
dist(data_scaled)
write.csv(row_name_id,"1stmatrix")
write.csv(row_name_id,"1stmatrix.csv")
#엑셀로 군집분석 돌린 것
library(xlsx)
setwd("~/동아리/공모전/시각화/R코드")
excel_data = read.xlsx("~/동아리/공모전/시각화/R코드/1stmatrix_ID_NUM.xlsx",
sheet = "str",
colIndex = 1:2,
rowIndex = 1:95661,
encoding = "UTF-8")
excel_data = read.xlsx("~/동아리/공모전/시각화/R코드/1stmatrix_ID_NUM.xlsx",
sheet = 4,
colIndex = 1:2,
rowIndex = 1:95661,
encoding = "UTF-8")
excel_data = read.xlsx("~/동아리/공모전/시각화/R코드/1stmatrix_ID_NUM.xlsx",
sheetIndex = 4,
colIndex = 1:2,
rowIndex = 1:95661,
encoding = "UTF-8")
library(readxl)
excel_data <- read_excel("~/동아리/공모전/시각화/R코드/1stmatrix_ID_NUM.xlsx",
sheet = 4)
View(excel_data)
excel_data <- read_excel("~/동아리/공모전/시각화/R코드/1stmatrix_ID_NUM.xlsx",
sheet = 4)
View(excel_data)
excel_data <- read_excel("~/동아리/공모전/시각화/R코드/1stmatrix_ID_NUM.xlsx",
sheet = 4,
colIndex = 1:2)
excel_data <- read_excel("~/동아리/공모전/시각화/R코드/1stmatrix_ID_NUM.xlsx",
sheet = 4,
col = 1:2)
excel_data <- excel_data[,1:2]
View(excel_data)
View(new_data)
cluster_data <- bind_cols(excel_data,new_data)
library(dplyr)
install.packages("dplyr")
install.packages("dplyr")
library(dplyr)
cluster_data <- bind_cols(excel_data,new_data)
#결측값이 포함된 행 제거
new_data_allrow_del<- na.omit(new_data) # na.omit : 결측값이 있는 행 자체를 제거
a <- as.matrix(new_data_allrow_del)
rownames(a) <- new_data_allrow_del$ID
row_name_id_1 <- a[,-1]
row_name_id_2 <- row_name_id_1[,-8:-9]
row_name_id = mapply(row_name_id, FUN = as.numeric)
row_name_id <- matrix(row_name_id, ncol = 21, nrow = 95660)
rownames(row_name_id) <- new_data_allrow_del$ID
colnames(row_name_id) <- c("건강만족도","가족수입만족도","주거환경만족도","가족관계만족도","
직업만족도","사회적친분관계만족도","여가생활만족도","졸업(중학교)",
"졸업(초등학교)","졸업(대학교)","졸업(전문대학)","졸업(고등학교)","미취학(7세미만)",
"미취학(7세이상)","졸업(석사)","졸업(박사)","지역구분(서울)","지역구분(시)",
"지역구분(광역시)","지역구분(군)","지역구분(도농복합군)")
row_name_id_2 = mapply(row_name_id, FUN = as.numeric)
row_name_id = mapply(row_name_id_2, FUN = as.numeric)
row_name_id<- matrix(row_name_id_2, ncol = 21, nrow = 95660)
rownames(row_name_id) <- new_data_allrow_del$ID
colnames(row_name_id) <- c("건강만족도","가족수입만족도","주거환경만족도","가족관계만족도","
직업만족도","사회적친분관계만족도","여가생활만족도","졸업(중학교)",
"졸업(초등학교)","졸업(대학교)","졸업(전문대학)","졸업(고등학교)","미취학(7세미만)",
"미취학(7세이상)","졸업(석사)","졸업(박사)","지역구분(서울)","지역구분(시)",
"지역구분(광역시)","지역구분(군)","지역구분(도농복합군)")
View(row_name_id)
cluster_data <- bind_cols(excel_data,new_data)
row_name_id_1 <- a[,-1]
row_name_id_2 <- row_name_id_1[,-8:-9]
row_name_id = mapply(row_name_id_2, FUN = as.numeric)
row_name_id<- matrix(row_name_id, ncol = 21, nrow = 95660)
rownames(row_name_id) <- new_data_allrow_del$ID
colnames(row_name_id) <- c("건강만족도","가족수입만족도","주거환경만족도","가족관계만족도","
직업만족도","사회적친분관계만족도","여가생활만족도","졸업(중학교)",
"졸업(초등학교)","졸업(대학교)","졸업(전문대학)","졸업(고등학교)","미취학(7세미만)",
"미취학(7세이상)","졸업(석사)","졸업(박사)","지역구분(서울)","지역구분(시)",
"지역구분(광역시)","지역구분(군)","지역구분(도농복합군)")
row_name_id <- as.data.frame(row_name_id)
cluster_data <- bind_cols(excel_data,new_data)
cluster_data <- bind_cols(excel_data,row_name_id)
View(cluster_data)
View(excel_data)
View(row_name_id)
install.packages("kmeans")
library(cluster)
library(NbClust)
nc <- NbClust(row_name_id, min.nc = 2, max.nc = 1000, method = "kmeans")
nc <- NbClust(row_name_id, min.nc = 2, max.nc = 15, method = "kmeans")
View(row_name_id)
str(row_name_id)
is.na(row_name_id)
nc <- NbClust(row_name_id, min.nc = 2, max.nc = 15, method = "kmeans")
data_kmeans <- kmeans(row_name_id, centers = 5, iter.max = 1000)
View(data_kmeans)
data_kmeans$centers
order <- c(1:115492)
new_data <- cbind(order,new_data)
data_13 <- new_data[new_data$order%%13 == 0,]
data_13_non_na <- na.omit(data_13)
data_13_binom_region <- data_13_non_na[,21:25]
dist(data_13_binom_region, method = "Jaccard")
#install.packages("proxy"), 자카드거리/자카드계수 계산
library(proxy)
dist(data_13_binom_region, method = "Jaccard")
dist <- dist(data_13_binom_region, method = "Jaccard")
View(dist)
dist <- as.data.frame(dist)
dist <- dist(data_13_binom_region,dist_13_binom_region, method = "Jaccard")
dist <- dist(data_13_binom_region,data_13_binom_region, method = "Jaccard")
str(dist)
View(dist)
plot(dist)
View(data_13_binom_region)
aaa <- data_13_binom_region[1:5,]
aaa_dist <- dist(aaa, method = "Jaccard")
View(aaa_dist)
aaa_dist
library(cluster)
gower_dist <- daisy(data_13_binom_region,metric = c("gower"))
class(gower_dist)
agg_clust <- hclust(gower_dist, method = "complete")
plot(agg_clust)
?diasy
?daisy
#결측값이 포함된 행 제거
new_data_allrow_del<- na.omit(new_data) # na.omit : 결측값이 있는 행 자체를 제거
a <- as.matrix(new_data_allrow_del)
rownames(a) <- new_data_allrow_del$ID
row_name_id_1 <- a[,-1]
row_name_id_2 <- row_name_id_1[,-8:-9]
row_name_id = mapply(row_name_id_2, FUN = as.numeric)
row_name_id<- matrix(row_name_id, ncol = 21, nrow = 95660)
rownames(row_name_id) <- new_data_allrow_del$ID
colnames(row_name_id) <- c("건강만족도","가족수입만족도","주거환경만족도","가족관계만족도","
직업만족도","사회적친분관계만족도","여가생활만족도","졸업(중학교)",
"졸업(초등학교)","졸업(대학교)","졸업(전문대학)","졸업(고등학교)","미취학(7세미만)",
"미취학(7세이상)","졸업(석사)","졸업(박사)","지역구분(서울)","지역구분(시)",
"지역구분(광역시)","지역구분(군)","지역구분(도농복합군)")
row_name_id <- as.data.frame(row_name_id)
gower_d <- daisy(row_name_id, metric = "gower")
#결측값이 포함된 행 제거
new_data_allrow_del<- na.omit(new_data) # na.omit : 결측값이 있는 행 자체를 제거
#install.packages("NbClust")
library(NbClust)
a <- as.matrix(new_data_allrow_del)
rownames(a) <- new_data_allrow_del$ID
row_name_id_1 <- a[,-1]
row_name_id_2 <- row_name_id_1[,-8:-9]
row_name_id = mapply(row_name_id_2, FUN = as.numeric)
row_name_id<- matrix(row_name_id, ncol = 21, nrow = 95660)
rownames(row_name_id) <- new_data_allrow_del$ID
colnames(row_name_id) <- c("건강만족도","가족수입만족도","주거환경만족도","가족관계만족도","
직업만족도","사회적친분관계만족도","여가생활만족도","졸업(중학교)",
"졸업(초등학교)","졸업(대학교)","졸업(전문대학)","졸업(고등학교)","미취학(7세미만)",
"미취학(7세이상)","졸업(석사)","졸업(박사)","지역구분(서울)","지역구분(시)",
"지역구분(광역시)","지역구분(군)","지역구분(도농복합군)")
row_name_id <- as.data.frame(row_name_id)
write.csv(row_name_id,"더미화자료.csv")
getwd()
